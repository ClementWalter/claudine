# Learning: Hook System for Skill-Based Learning Summaries

## DO

- Use `systemMessage` field in hook JSON output (not
  `hookSpecificOutput.additionalContext`)
- Use `uv run --python 3.12` with PEP 723 metadata for modern Python features
- Use `printf` instead of `echo` when testing hooks with JSON to avoid shell
  escaping issues
- Append to marker file (list format) to support multiple skills per session
- Delete marker file after triggering to make it one-time

## DON'T

- Don't use `$HOME` in hook commands - use absolute paths
- Don't rely on `UserPromptSubmit` hook in global settings.json (may only work
  via plugins)
- Don't use Python 3.7 features like `missing_ok=False` default - use explicit
  `missing_ok=True`
- Don't use `echo '...'` with `!` characters - shell escapes them as `\!`

## Context

Built a two-hook system for automatic learning summaries after skill usage:

1. `PostToolUse:Skill` hook creates/appends to marker file when skills are
   invoked
2. `UserPromptSubmit` hook detects "magic phrases" (looks good, done, ship it,
   etc.) to trigger summary creation

Discovered that `UserPromptSubmit` may not be available in global
settings.json - might need to be implemented via a plugin instead.
